"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[872],{3905:(e,t,o)=>{o.d(t,{Zo:()=>c,kt:()=>g});var n=o(7294);function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){i(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,i=function(e,t){if(null==e)return{};var o,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(i[o]=e[o]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):r(r({},t),e)),o},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var o=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(o),g=i,m=d["".concat(s,".").concat(g)]||d[g]||u[g]||a;return o?n.createElement(m,r(r({ref:t},c),{},{components:o})):n.createElement(m,r({ref:t},c))}));function g(e,t){var o=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=o.length,r=new Array(a);r[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var p=2;p<a;p++)r[p]=o[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,o)}d.displayName="MDXCreateElement"},5959:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var n=o(7462),i=(o(7294),o(3905));const a={sidebar_position:3,description:"Google Play real-time developer notifications guide."},r="Google Play RTDN",l={unversionedId:"server-notifications/google-play",id:"server-notifications/google-play",title:"Google Play RTDN",description:"Google Play real-time developer notifications guide.",source:"@site/docs/server-notifications/google-play.mdx",sourceDirName:"server-notifications",slug:"/server-notifications/google-play",permalink:"/laravel-iap-docs/docs/server-notifications/google-play",draft:!1,editUrl:"https://github.com/imdhemy/laravel-iap-docs/blob/master/docs/server-notifications/google-play.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Google Play real-time developer notifications guide."},sidebar:"tutorialSidebar",previous:{title:"App Store Server Notifications",permalink:"/laravel-iap-docs/docs/server-notifications/app-store"},next:{title:"Available Events",permalink:"/laravel-iap-docs/docs/server-notifications/event-list"}},s={},p=[{value:"Overview",id:"overview",level:2},{value:"Setup",id:"setup",level:2},{value:"Create a topic",id:"create-a-topic",level:3},{value:"Create a Pub/Sub subscription",id:"create-a-pubsub-subscription",level:3},{value:"Grant publish rights on your topic",id:"grant-publish-rights-on-your-topic",level:3},{value:"Enable Real-time developer notifications for your app",id:"enable-real-time-developer-notifications-for-your-app",level:3}],c={toc:p};function u(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"google-play-rtdn"},"Google Play RTDN"),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"Google Play RTDN leverage the use of ",(0,i.kt)("a",{parentName:"p",href:"https://cloud.google.com/pubsub/"},"Google Cloud Pub/Sub"),"\nto send real-time notifications that allows you to react\nimmediately to changes in the subscription state, avoiding the need to poll\nthe API."),(0,i.kt)("p",null,"To receive notifications, you need to create a backend server to consume the\nmessages sent to your topic. This is provided out of the box by ",(0,i.kt)("strong",{parentName:"p"},"LIAP"),"."),(0,i.kt)("p",null,"To use Cloud Pub/Sub, you must have a Google Cloud Platform project with\nCloud Pub/Sub enabled. Check the ",(0,i.kt)("a",{parentName:"p",href:"https://cloud.google.com/pubsub/docs/quickstart-console"},"Quickstart guide"),"\nfor more information."),(0,i.kt)("h2",{id:"setup"},"Setup"),(0,i.kt)("p",null,"The following steps are required to receive notifications:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create a topic."),(0,i.kt)("li",{parentName:"ul"},"Create Pub/Sub a subscription."),(0,i.kt)("li",{parentName:"ul"},"Grant the service account permission to publish messages to the topic."),(0,i.kt)("li",{parentName:"ul"},"Enable Real-time developer notifications for your app.")),(0,i.kt)("h3",{id:"create-a-topic"},"Create a topic"),(0,i.kt)("p",null,"To create a topic, you can use the ",(0,i.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/cloudpubsub?walkthrough_id=pubsub_quickstart"},"Guide me"),"\nfeature provided by Google that guides you through the process of creating a\ntopic."),(0,i.kt)("p",null,(0,i.kt)("img",{src:o(1357).Z,width:"562",height:"635"})),(0,i.kt)("p",null,"Or you can use the ",(0,i.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/cloudpubsub/topicList"},"Google Cloud Console"),",\nwhich is a simple interface for managing topics."),(0,i.kt)("p",null,"Then Click on the ",(0,i.kt)("strong",{parentName:"p"},"Create a topic")," button. In the ",(0,i.kt)("strong",{parentName:"p"},"Topic ID")," field,\nenter a unique ID for your topic, then click ",(0,i.kt)("strong",{parentName:"p"},"Save"),"."),(0,i.kt)("h3",{id:"create-a-pubsub-subscription"},"Create a Pub/Sub subscription"),(0,i.kt)("p",null,"To receive messages from the topic, you need to create a subscription to\nthat topic. To create a subscription, do the following:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Display the menu for the topic you just created."),(0,i.kt)("li",{parentName:"ol"},"Click on the ",(0,i.kt)("strong",{parentName:"li"},"Create a subscription")," button."),(0,i.kt)("li",{parentName:"ol"},"Type the name of the subscription."),(0,i.kt)("li",{parentName:"ol"},"Choose ",(0,i.kt)("strong",{parentName:"li"},"Push to endpoint")," as the delivery Type."),(0,i.kt)("li",{parentName:"ol"},"Enter the ",(0,i.kt)("a",{parentName:"li",href:"http://localhost:3000/laravel-iap-docs/docs/get-started/routing#generate-a-signed-url"},"URL of the backend server"),"\nyou created in the ",(0,i.kt)("strong",{parentName:"li"},"Endpoint URL"),"."),(0,i.kt)("li",{parentName:"ol"},"Click on the ",(0,i.kt)("strong",{parentName:"li"},"Create")," button.")),(0,i.kt)("p",null,(0,i.kt)("img",{src:o(3518).Z,width:"563",height:"433"})),(0,i.kt)("h3",{id:"grant-publish-rights-on-your-topic"},"Grant publish rights on your topic"),(0,i.kt)("p",null,"Google Pub/Sub requires that you grant Google Play the permission to publish\nnotifications to your topic. To do this:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Find your topic in the Google Cloud Console."),(0,i.kt)("li",{parentName:"ol"},"Open the permissions details.")),(0,i.kt)("p",null,(0,i.kt)("img",{src:o(1315).Z,width:"614",height:"467"})),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the right side of the page, click on the ",(0,i.kt)("strong",{parentName:"p"},"Add Principal")," button.\n",(0,i.kt)("img",{src:o(524).Z,width:"403",height:"172"}))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add the service account"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"google-play-developer-notifications@system.gserviceaccount.com")," ,\nand grant it the role of ",(0,i.kt)("strong",{parentName:"p"},"Pub/Sub Publisher"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{src:o(8410).Z,width:"642",height:"601"})),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Click Save to complete the topic set up.")),(0,i.kt)("h3",{id:"enable-real-time-developer-notifications-for-your-app"},"Enable Real-time developer notifications for your app"),(0,i.kt)("p",null,"To enable real-time developer notifications for your app, do the following:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Go to the ",(0,i.kt)("a",{parentName:"li",href:"https://play.google.com/console/"},"Google Play Console"),"."),(0,i.kt)("li",{parentName:"ol"},"Select your app."),(0,i.kt)("li",{parentName:"ol"},"Go the ",(0,i.kt)("strong",{parentName:"li"},"Monetize > Monetization")," tab."),(0,i.kt)("li",{parentName:"ol"},"Scroll down to the ",(0,i.kt)("strong",{parentName:"li"},"Real-time developer notifications")," section.\n",(0,i.kt)("img",{src:o(4020).Z,width:"931",height:"421"})),(0,i.kt)("li",{parentName:"ol"},"In the ",(0,i.kt)("strong",{parentName:"li"},"Topic name")," field, enter the name of the topic you created. It\nshould be in the format ",(0,i.kt)("inlineCode",{parentName:"li"},"projects/{project_id}/topics/{topic_name}"),"."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Save changes"),".")),(0,i.kt)("admonition",{title:"Warning:::",type:"warning"},(0,i.kt)("p",{parentName:"admonition"},"Sending a ",(0,i.kt)("strong",{parentName:"p"},"Test Message")," requires a deployed endpoint to receive the\nmessage, otherwise the message will keep trying to be sent.")),(0,i.kt)("p",null,"Test messages are logged by LIAP out of the box, so you can see the messages\nin the logs."))}u.isMDXComponent=!0},3518:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/create-pub-sub-subscription-ef2d602b862d9987a2dc3b455194382d.png"},1357:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/google-play-create-topic-guide-me-d8cf5fc6a753e1d2c822def7bc9ac249.png"},4020:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/google-play-monetization-real-time-developer-notifications-b71df0d0ad242bc2f61f8a64af1498b2.png"},8410:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/google-play-topic-add-principal-service-account-4383f1bf9966997219ed27c6569daa9f.png"},524:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/google-play-topic-add-principal-06e4911d9ec5525bfac1fde3d147e13b.png"},1315:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/google-play-topic-permissions-9b88a3456b4f9b2cc488d8976a6b774e.png"}}]);